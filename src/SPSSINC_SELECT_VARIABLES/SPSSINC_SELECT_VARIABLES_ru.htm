<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Определение макрокоманды, выводящей список выбранных переменных</title>
<STYLE TYPE="text/css"> 
<!-- 

H1 {font-weight:bold; color:#006699; font-size:125%; }
H2 {font-weight:bold; color:#006699; font-size:110%; }
BODY {font-size:80%; }
TABLE {font-size:100%;}

/* paragraph tags */
.step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
.step-glyph {  }
.menuselection {margin-left:10px}
.bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
.codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px; }

/* inline tags */
.code {}                           /*** used to tag pieces of code (syntax, Python, R, HTML, etc.)   ***/
.screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
.name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
.runinhead {font-weight: bold} 
.superscript {vertical-align:super; font-size:80%}
.subscript {vertical-align:sub; font-size:80%}
.symbol {}

--> 
</STYLE>
</head>
<body>
<h1>Определить макрокоманду, выводящую список выбранных переменных</h1>
Эта команда обеспечивает возможность определить макрокоманду SPSS, значение которой - это список переменных, удовлетворяющих некоторым критериям, таким как уровень измерений, тип, атрибуты переменных и блоки символов в именах.
<p>
Используя этот подход, можно создать обобщенные задания синтаксиса, не зависящие от знания точных имен переменных в конкретном файле данных.  Например, можно создать задание, выводящее соответствующие данные описательной статистики для переменных в наборе данных на основании их уровня измерений.

<p><span class="runinhead">Имя макроопределения.</span>
Введите имя для создающейся макрокоманды.  По договоренности имена начинаются с "!" , чтобы избежать конфликта с именами переменных.

<p><span class="runinhead">Переменные и ограничение выбора.</span> 
Переместите переменные в элемент управления <span class="screen">Ограничить выбор до</span>, чтобы ограничить результат подмножеством только таких имен.  Если другие критерии не заданы, макрокоманда определит именно эти имена.
<p class="bullet">&bull;Если управляющий элемент Ограничение оставлен пустым, другие критерии будут применены ко всем переменным.

<p><span class="runinhead">Тип переменной.</span> 
Ограничить выбор числовыми переменными, строковыми переменными или обоими типами (нет ограничения).

<p><span class="runinhead">Уровень переменной.</span> 
Выберите для применения критерии уровня измерений переменных.

<p><span class="runinhead">Роль переменной.</span> 
В пакете Statistics версии 18 или новее у переменных может быть назначенная роль.
Выберите для применения критерий роли.  В версии 17 этот критерий игнорируется.
<p class="bullet">&bull;В частности, роли полезны, если это диалоговое окно будет использоваться в Modeler.

<p><span class="runinhead">Регулярное выражение для имени переменной.</span>
Чтобы отфильтровать переменные на основании их имен, можно ввести <em>регулярное выражение</em>.
Регулярное выражение описывает блок символов (паттерн).
Этот паттерн не зависит от регистра и начинается с первого символа имени.  Примеры:

<p>age  - все переменные, имена которых начинаются с age<br>
<p>.*age - все переменные, имена которых содержат age<br>
<p>.*\d$  - Все переменные, имена которых заканчиваются на цифру

<h2>Атрибуты.</h2> 
В диалоговом подокне Атрибуты можно задать критерии на основании пользовательских атрибутов.
Пользовательские атрибуты - это свойства переменных, которые можно создать с помощью команды VARIABLE ATTRIBUTE, в диалоговом окне Определение свойств переменных или в редакторе данных.  Атрибуты можно сохранить с набором данных.

<p><span class="runinhead">У переменных должны быть все эти атрибуты.</span> 
У выбранных переменных должны быть все названные здесь атрибуты.  Введите один или несколько атрибутов (несколько атрибутов отделяются пробелами).  Значение атрибута, если оно есть, несущественно.

<p><span class="runinhead">У переменных должен быть хотя бы один из этих атрибутов.</span> 
Переменные будут удовлетворять этому критерию, если у них есть по крайней мере один из перечисленных атрибутов.
Введите одно имя атрибута или несколько имен, разделенных пробелами.
Значение атрибута, если оно есть, несущественно.  Регистр символов в именах не учитывается.

<p><span class="runinhead">Значения атрибута.</span>
Введите имена атрибутов и списки значений, чтобы ограничить выбранные переменные только теми, у которых значения атрибутов совпадают с перечисленными.  Можно ввести до трех наборов имен и значений.
<p class="bullet">&bull;Каждое значение надо заключить в одинарные или двойные кавычки, а если значений несколько, их нужно разделить пробелами.  
<p class="bullet">&bull;Значения зависят от регистра: если у атрибута переменной с именем <em>units</em> значение <em>EUROS</em>, чтобы выбрать переменную, в поле значения для units нужно ввести "EUROS".
<p class="bullet">&bull;Если у переменной нет заданного атрибута, этот тест игнорируется.  Внесите атрибут в элемент управления <span class="screen">У переменных должны быть все эти атрибуты</span>, чтобы исключить переменные, у которых нет данного атрибута.
<p class="bullet">&bull;Когда атрибут - это массив, то есть для одного атрибута может быть несколько значений, переменная удовлетворяет критерию, если любое из значений этого массива совпадает со значением в списке <span class="screen">Значения атрибутов</span>.

<h2>Параметры</h2>
<p><span class="runinhead">Порядок выбранных переменных в макрокоманде.</span>
Можно задать, чтобы список переменных, определенный макрокомандой, был упорядочен по алфавиту или строился в том же порядке, что и переменные в файле.  Если выбрана опция Как перечислено, все переменные в списке Ограничить выбор до, передающем другие условия, в определении макрокоманды появятся в перечисленном порядке.

<p><span class="runinhead">Если переменные не выбраны.</span> 
Если никакие переменные не удовлетворяют критериям выбора, можно или создать сообщение об ошибке и не определять макрокоманду, или сгенерировать пустую макрокоманду.
Код пустой макрокоманды будет проверен позже, чтобы избежать появления ошибок из-за пустоты макрокоманды.

<p><span class="runinhead">Вывод определения макрокоманды.</span> 
Выберите, выводить ли содержимое макрокоманд в сводной таблице.

<p><span class="runinhead">Символ разделителя.</span> 
Выберите, как разделять имена переменных в определении макрокоманды - пробелами или знаками +.  Знак плюс полезен для выражений TABLE в пользовательских таблицах.

<h2>Дополнительные возможности</h2>
Введите команду<br>
SPSSINC SELECT VARIABLES /HELP.<br>
чтобы вывести полное описание синтаксиса.
<p>Программисты, работающие с Python, могут использовать SPSSINC_SELECT_VARIABLES.macrodict - словарь макрокоманд, определенных этой командой.
<p>Перечень ролей может быть указан.</p>
<p>В синтаксисе вместе с конкретными переменными можно использовать TO и ALL.</p>

<h2>Требования</h2>
Этой команде требуется подключаемый модуль программирования Python.
Его можно найти на установочном компакт-диске IBM SPSS Statistics или скачать с сайта SPSS Developer Central (www.spss.com/devcentral).</p>
  <hr>
  <p style="font-size:80%;">
  Copyright IBM Corp. 2014</p>
</body>
</html>

